// ğŸ“ telegramTriggers.js â€“ ×›×•×œ×œ mentionTriggers ×•×©×™×¤×•×¨×™× ×œ×¢×‘×¨×™×ª + ×¢×™×¦×•×‘ HTML

const linkRegex = /(https?:\/\/[^\s]+)/i;

const linkReplies = [
  "××” ×–×” ×”×œ×™× ×§ ×”×–×” ×™× × ×•××©? ğŸ”—",
  "×¢×•×“ ×¤×¢× ×œ×™× ×§? ×ª×œ××“ ×œ×—×™×•×ª ×‘×¢×•×œ× ×”×××™×ª×™ ğŸ”—",
  "×× ×–×” ×œ× ×§×©×•×¨ ×œÖ¾Warzone ×ª××—×•×§ ××ª ×–×” ××™×“ ğŸ”—",
  "×©××¢×ª×™ ×©×™×© ×˜×™×¤×•×œ ×œ×§×œ×™×§Ö¾××—×œ×” ğŸ”—",
  "×× ×–×” ×¤×•×¨× ×• â€“ ×œ×¤×—×•×ª ×©×ª×£ ×¢× ×ª×™××•×¨ ğŸ”—",
  "×× ×–×” ×—×™× ××™ â€“ ×©×œ×— ×œ×™ ×‘×¤×¨×˜×™ ğŸ”—",
  "×©××¢×•×Ÿ ××•×—×§ × ×§×•×“×•×ª ×›×œ ×¤×¢× ×©××ª×” ××©×ª×£ ×›×›×” ğŸ”—",
  "×”××©×˜×¨×” ×›×‘×¨ ××™×ª×š ×¢×œ ×”×§×• ğŸ”—",
  "×©×•×œ×— ×œ×™× ×§×™× ×›××• ××™×× ×©×œ×š ×‘×‘×•×§×¨ ğŸ”—",
  "×›×‘×¨ ×¢×“×™×£ ×©×ª×©×œ×— ×’×™×£ ×©×œ ×¤×™×¦×” ğŸ”—",
  "×›×œ ×¤×¢× ×©××ª×” ×©×•×œ×— ×œ×™× ×§, ×™×•×’×™ ××¤×¡×™×“ ×‘Ö¾Rocket League ğŸ”—",
  "×¨×•×¢×™ ×¤×¨×© ××”×§×‘×•×¦×” ×‘×’×œ×œ ×–×” ğŸ”—",
  "×©×•×œ×— ×œ×™× ×§ ×•×—×•×©×‘ ×©×¡×™×™× ××ª ×ª×¤×§×™×“×• ğŸ”—",
  "×”×¢×•×œ× ×œ× ××•×›×Ÿ ×œ××” ×©×©×œ×—×ª ×›×¨×’×¢ ğŸ”—",
  "×œ×™× ×§ ×‘×œ×™ ×œ×”×¡×‘×™×¨ â€“ ×‘×•×©×” ×•×—×¨×¤×” ğŸ”—",
  "×›× ×¨××” ×™×© ×œ×š ×™×•×ª×¨ ×œ×™× ×§×™× ×××™×œ×™× ğŸ”—",
  "×œ×™× ×§ ×‘×œ×™ ×§×•× ×˜×§×¡×˜? ×–×” ×›××• ×ª×™×¨×•×¥ ×‘×œ×™ ××•×•×ª ğŸ”—",
  "×”×¢×›×‘×¨ ×©×œ×š ××—×œ×™×§ ×¢×œ ×”×œ×™× ×§×™× ××¨×•×‘ ×™××•×© ğŸ”—",
  "× ×• ×‘×××ª, ×œ×™× ×§ ×‘××§×•× ×œ×ª×™×™×’? ğŸ”—"
];

const keywordTriggers = {
  ××©×—×§: [
    "××™ ××©×—×§? ×›× ×¨××” ×œ× ××ª×”... ğŸ®",
    "×ª×©××œ ××ª ××× ×× ××•×ª×¨ ×œ×š ×œ×©×—×§ ğŸ®",
    "×©×•××œ ×›×œ ×©×‘×•×¢, ×œ× ××—×•×‘×¨ ××£ ×¤×¢× ğŸ®",
    "×”×’×™×¢ ×”×–××Ÿ ×©×ª×¤×¡×™×§ ×œ×©××•×œ ×•×ª×ª×—×™×œ ×œ×¤×¢×•×œ ğŸ®",
    "×©××¢×•×Ÿ ×©×•× × ×—×•×¡×¨ ×”×—×œ×˜×™×•×ª. ×ª×™×›× ×¡ ××• ×ª×©×ª×•×§ ğŸ®",
    "×©×•×‘ ××ª×” ×¢× ×”×©××œ×” ×”×–××ª? ×ª×©×ª× ×” ×›×‘×¨ ğŸ®",
    "×ª×‘×“×•×§ ×× ×”×›×‘×œ ×©×œ ×”××™×§×¨×•×¤×•×Ÿ ××—×•×‘×¨ ×§×•×“× ğŸ®",
    "××ª×” ×©×•××œ '××™ ××©×—×§' ×›×‘×¨ 3 ×©× ×™×. ×ª×‘×™×Ÿ ×œ×‘×“ ğŸ®",
    "×¨×•×¢×™ ×¢×¡×•×§ ×‘Ö¾Helldivers 2, ×™×•×’×™ ×©×•×‘ ×‘×¨×•×§×˜ ×œ×™×’ ğŸ®",
    "×”××©×—×§ ×”×™×—×™×“ ×©××ª×” ××•×‘×™×œ ×‘×• ×–×” ××—×‘×•××™× ××”×¢×›×‘×¨ ğŸ®"
  ],
  ×¢×•×œ×”: [
    "×”×§×‘×•×¦×” ×œ× ×¦×¨×™×›×” ××•×ª×š â¬†ï¸",
    "××£ ××—×“ ×œ× ×‘×™×§×© ×©×ª×¢×œ×” â¬†ï¸",
    "××ª×” ×¢×•×œ×”? ×ª×•×•×“×™×¢ ×©× ×›×‘×” ×©×¨×ª â¬†ï¸",
    "×©××¢×•×Ÿ ×œ× ×××©×¨ ×¢×œ×™×™×” ×‘×œ×™ ××™×©×•×¨ ××™×œ×•××™× â¬†ï¸",
    "×¤×—×•×ª ×”×•×“×¢×•×ª, ×™×•×ª×¨ ×¢×œ×™×•×ª â¬†ï¸",
    "×‘×•× × ×¨××” ××•×ª×š ×¢×•×œ×” ×‘×××ª, ×œ× ×¨×§ ××“×‘×¨ â¬†ï¸",
    "××ª×™ ×‘×¤×¢× ×”××—×¨×•× ×” ×‘×××ª ×¢×œ×™×ª? â¬†ï¸",
    "×”×©×¨×ª ×¨×•×¢×“ ××¨×•×‘ ×¢×œ×™×•×ª ××–×•×™×¤×•×ª â¬†ï¸",
    "×¢×œ×™×ª? ×¨×•××™× â€“ ×œ×¤×™ ×”×ª×™×¨×•×¦×™× ×©×œ×š â¬†ï¸",
    "×ª×¢×œ×” â€“ ××‘×œ ×‘×©×§×˜. ×©××¢×•×Ÿ ×××–×™×Ÿ â¬†ï¸"
  ],
  ××—×•×‘×¨: [
    "×©××¢×•×Ÿ ×ª××™×“ ××—×•×‘×¨. ××ª×” ×œ×. ğŸ“¶",
    "××—×•×‘×¨ ×‘×œ×‘, ×× ×•×ª×§ ×‘××™×™×¤×•×Ÿ ğŸ“¶",
    "××—×•×‘×¨? ×’× ×× ×™. ××– ××”? ğŸ“¶",
    "×©×•×‘ ××ª×” ×‘×•×“×§ ×× ××™×©×”×• ×¨×•××” ××•×ª×š ğŸ“¶",
    "×ª×ª× ×ª×§ ×•×ª×ª×—×‘×¨ ×œ×—×™×™× ×”×××™×ª×™×™× ğŸ“¶",
    "×”×—×™×‘×•×¨ ×©×œ×š ×¤×—×•×ª ×™×¦×™×‘ ××”××™×§×¨×•×¤×•×Ÿ ×©×œ ××ª×Ÿ ğŸ“¶",
    "×× ×”×™×™×ª ×‘×××ª ××—×•×‘×¨, ×”×™×™×ª ×©×§×˜ ×›×‘×¨ ğŸ“¶",
    "××—×•×‘×¨, ××‘×œ ×‘× ×©××” ×œ× ×‘××©×—×§ ğŸ“¶",
    "×—×™×‘×¨×ª ×’× ××ª ×”××•×–× ×™×•×ª ××• ×¨×§ ××ª ×”×¢×¦×‘×™×? ğŸ“¶"
  ],
  ××—×™: [
    "×× ×™ ×œ× ××— ×©×œ×š. ×“×‘×¨ ×‘×¨×•×¨. ğŸ¤¨",
    "×¤×¢× ××—×¨×•× ×” ×©××™×©×”×• ×§×¨× ×œ×™ ××—×™, ×–×” × ×’××¨ ×‘××™×•×˜ ğŸ¤¨",
    "×©××¢×•×Ÿ ×œ× ××•×”×‘ ××—×•×§×™×. ×¨×§ ×’×‘×¨×™× ğŸ¤¨",
    "×ª×’×™×“ ××—×™ ×¢×•×“ ×¤×¢× ××—×ª ×•×× ×™ ×©×•×œ×— ××•×ª×š ×œ×’×•×œ××’ ğŸ¤¨",
    "×ª×’×™×“ ×©×, ×œ× ××—×™. ×©××•×¨ ×¢×œ ×›×‘×•×“ ğŸ¤¨",
    "××—×™ ××—×™ ××—×™... × ×××¡ ğŸ¤¨",
    "×¤×¢× ×§×¨××• ×œ×™ ××—×™. ×¢×›×©×™×• ×”× ×©×•×ª×§×™× ğŸ¤¨",
    "×™××œ×œ×”, ××—×™... ×œ×š ×ª×¢×©×” ××©×”×• ×¢× ×¢×¦××š ğŸ¤¨",
    "×©××¢×•×Ÿ ×œ× ××ª×—×‘×¨ ×œ××™ ×©×§×•×¨× ×œ×• ××—×™ ğŸ¤¨"
  ]
};

const mentionTriggers = [
  "××” ××ª×” ×¨×•×¦×” ××× ×™ ×‘×“×™×•×§? ğŸ¤”",
  "×ª×ª××•×“×“ ×œ×‘×“ ×¤×¢× ××—×ª ğŸ¤·â€â™‚ï¸",
  "×©×•×‘ ××ª×” ×¢× ×”×ª×™×•×’×™×? ğŸ¤¨",
  "×× ×™ ×¤×” ×¨×§ ×œ×¦×—×•×§ ×¢×œ×™×š, ×œ× ×œ×¢×–×•×¨ ğŸ˜",
  "×”×©×ª××©×ª ×‘×ª×’? ×§×— × ×‘×™×—×” ğŸ¶",
  "×ª×™×•×’ ×–×” ×œ×—×œ×©×™× ğŸ’¢",
  "×™×© ×œ×š ×‘×¢×™×”? ×“×‘×¨ ×¢× ×¢×¦××š ğŸª",
  "×©××¢×•×Ÿ ×¢×¡×•×§ ×‘×œ×¦×—×•×§ ×¢×œ ××—×¨×™× ×›×¨×’×¢ ğŸ¤¡",
  "×ª×™×•×’ ××™×•×ª×¨. ×›××™×œ×• ×©×× ×™ ××›×¤×ª ×œ×™ ğŸ¤–",
  "×›×œ ×ª×™×•×’ ××•×¨×™×“ ×œ×š × ×§×•×“×•×ª FIFO ğŸ§¾",
  "×ª×™×•×’ ××•×ª×™? ××§×•×•×” ×©××ª×” ×’× ××‘×©×œ ğŸ³",
  "×©××¢×•×Ÿ ×œ× ×¢×•×–×¨. ×©××¢×•×Ÿ ×¢×•×§×¥. ğŸ’‰"
];

let lastMessageTimestamp = 0;
let dailyReminderSent = false;

function getRandom(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function handleTrigger(ctx) {
  const text = ctx.message?.text?.toLowerCase() || "";
  const name = ctx.from?.first_name || "×—×‘×¨";

// âœ… ×–×™×”×•×™ ××ª×•×—×›×: ×œ× ×›×œ ××•×¤×¢ ×©×œ "×©××¢×•×Ÿ" ×™×¤×¢×™×œ ×˜×¨×™×’×¨
const triggerWords = ['×©××¢×•×Ÿ', 'bot', '×‘×•×˜', '×©×™××™', '×©××©×•×Ÿ'];
const isMention = triggerWords.some(word => {
  const isAlone = text.trim() === word;
  const isShortPing = text.trim().startsWith(word) && text.split(" ").length <= 3;
  return isAlone || isShortPing;
});


  if (isMention) {
    ctx.reply(`\u200F<b>${name}</b> â€“ ${getRandom(mentionTriggers)}`, { parse_mode: "HTML" });
    lastMessageTimestamp = Date.now();
    return { triggered: true, type: 'mention' };
  }

  // ğŸ”— ×œ×™× ×§
  if (linkRegex.test(text)) {
    ctx.reply(`\u200F<b>${name}</b> â€“ ${getRandom(linkReplies)}`, { parse_mode: "HTML" });
    lastMessageTimestamp = Date.now();
    return { triggered: true, type: 'link' };
  }

  // ğŸ§  ××™×œ×•×ª ××¤×ª×—
  for (const keyword in keywordTriggers) {
    if (text.includes(keyword)) {
      ctx.reply(`\u200F<b>${name}</b> â€“ ${getRandom(keywordTriggers[keyword])}`, { parse_mode: "HTML" });
      lastMessageTimestamp = Date.now();
      return { triggered: true, type: 'keyword', keyword };
    }
  }

  // ğŸ–¼ï¸ ×ª××•× ×”
  if (ctx.message?.photo) {
    ctx.reply(`\u200F<b>${name}</b> â€“ ×©×œ×—×ª ×ª××•× ×” â€“ ××‘×œ ×œ××”? ğŸ–¼ï¸`, { parse_mode: "HTML" });
    lastMessageTimestamp = Date.now();
    return { triggered: true, type: 'photo' };
  }

  // ğŸ­ ×¡×˜×™×§×¨
  if (ctx.message?.sticker) {
    ctx.reply(`\u200F<b>${name}</b> â€“ ×¡×˜×™×§×¨ ×‘××§×•× ×˜×§×¡×˜? ×©××¢×•×Ÿ ×©×•×§×œ ×§×™×§ ğŸ­`, { parse_mode: "HTML" });
    lastMessageTimestamp = Date.now();
    return { triggered: true, type: 'sticker' };
  }

  lastMessageTimestamp = Date.now();
  return { triggered: false };
}

// â° ×ª×–×›×•×¨×ª ×× ×œ× ×›×ª×‘×• ×›×œ×•× ××¢×œ 24 ×©×¢×•×ª
function checkDailySilence(bot, chatId) {
  const hours = (Date.now() - lastMessageTimestamp) / 1000 / 60 / 60;
  if (hours > 24 && !dailyReminderSent) {
    bot.api.sendMessage(chatId, "ğŸ“¢ ×©×§×˜ ×›×–×” ×œ× ×”×™×” ×××– ×©×™×•×’×™ ×©×‘×¨ ×©×œ×˜. ××™×©×”×• ×›××Ÿ?");
    dailyReminderSent = true;
  }
}

module.exports = {
  handleTrigger,
  checkDailySilence
};
